@page
@model NaturalDisasterInformationSystem.Pages.Areas.Charity.Update_InformationModel
@{
    var roleId = HttpContext.Session.GetString("RoleId") ?? Request.Cookies["RoleId"];
    var userId = HttpContext.Session.GetString("UserId") ?? Request.Cookies["UserId"];
    var charityId = HttpContext.Session.GetString("CharityId") ?? Request.Cookies["CharityId"];
}
<div style="background-image: url('/assets/images/bg_7.jpg'); background-size: cover; background-position: center center; background-attachment: fixed; min-height: 100vh; display: flex; align-items: center; justify-content: center; position: relative;">
    <div class="overlay" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 1;"></div>

    <div class="container" style="position: relative; z-index: 2; padding: 20px; max-width: 1400px; margin: 0 auto; width: 100%; padding-top: 73px;">
        <div class="profile-section" style="background-color: #ffffff; border-radius: 8px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); padding: 20px; margin: 20px 0;">
            <h2 class="fw-bold text-uppercase mb-4" style="margin-bottom: 20px; font-size: 24px; color: #333; text-align: center;">
                Danh sách cập nhật thông tin chiến dịch từ thiện
            </h2>
            @if (Model.VolunteerHistory != null && Model.VolunteerHistory.ProfileId != null && Model.VolunteerHistory.EventId == Model.Campaign.CampaignId && Model.VolunteerHistory.Status == "hoàn thành" && userId != null)
            {
                <button id="addButton" class="btn btn-outline-primary">Thêm Thông Tin</button>
                <button id="listButton" class="btn btn-outline-primary">Danh sách bài đăng của tôi</button>

            }
            else if (int.TryParse(charityId, out int parsedCharityId))
            {
                if (Model.Campaign.CharityId == parsedCharityId)
                {
                    <button id="addButton" class="btn btn-outline-primary">Thêm Thông Tin</button>
                    <button id="listButton" class="btn btn-outline-primary">Danh sách bài đăng của tôi</button>

                }
            }
            <!-- Add Information Modal -->
            <div id="listModal" class="modal" style="display: none; position: fixed; z-index: 1; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0, 0, 0, 0.4);">
                <div class="modal-content" style="background-color: #fefefe; margin: 5% auto; padding: 20px; border: 1px solid #888; width: 90%; max-width: 1000px; overflow-x: auto;">
                    <span class="close" onclick="document.getElementById('listModal').style.display='none'" style="color: #aaa; float: right; font-size: 28px; font-weight: bold;">&times;</span>
                    <div class="container">
                        <h2>Danh sách bài đăng của tôi</h2>
                        <table class="table table-striped" style="width: 100%; table-layout: fixed; word-wrap: break-word;">
                            <thead>
                                <tr>
                                    <th style="width: 40%;">Nội Dung</th>
                                    <th style="width: 30%;">Tên file Hình ảnh, Video</th>
                                    <th style="width: 20%;">Ngày tạo</th>
                                    <th style="width: 10%;">Trạng thái</th>
                                    <th style="width: 10%;"></th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var info in Model.ProjectInformationListU)
                                {
                                    <tr>
                                        <td style="word-wrap: break-word; white-space: normal; overflow: hidden; text-overflow: ellipsis; width: 40%;">
                                            @(info.Content.Length > 100 ? info.Content.Substring(0, 100) + "..." : info.Content)
                                        </td>
                                        <td style="word-wrap: break-word; white-space: normal; overflow: hidden; text-overflow: ellipsis;width: 30%;">
                                            @{
                                                // Giả sử info.Img là chuỗi như "image1.jpg,image2.jpg,image3.jpg"
                                                var imagePaths = info.Img?.Split(",") ?? Array.Empty<string>();
                                            }

                                            @foreach (var imagePath in imagePaths)
                                            {
                                                <a href="@($"/uploads/projectInformation/{imagePath.Trim()}")" target="_blank">@imagePath.Trim()</a>

                                                <br />
                                            }
                                        </td>
                                        <td style="word-wrap: break-word; white-space: normal; overflow: hidden; text-overflow: ellipsis;width: 20%;">@info.CreateDate.ToString("dd MM yyyy, HH:mm")</td>
                                        <td style="word-wrap: break-word; white-space: normal; overflow: hidden; text-overflow: ellipsis;width: 10%;">
                                            @if (info.Status == "0")
                                            {
                                                <span style="color:red">Chờ duyệt</span>
                                            }
                                            else if (info.Status == "1")
                                            {
                                                <span style="color:green">Đã duyệt</span>
                                            }
                                        </td>
                                        <td style="word-wrap: break-word; white-space: normal; overflow: hidden; text-overflow: ellipsis;width: 10%;">
                                            @if (info.Profile.UserId.ToString() == userId)
                                            {

                                                <button type="submit" style="background:#ffc107;" class="btn btn-sm"
                                                        onclick="showUpdateForm('@info.InformationId', '@Html.Raw(Html.Encode(info.Content))', '@info.Img', '@info.Video')">
                                                    Sửa
                                                </button>


                                                <!-- Update Project Modal -->
                                                <div id="updateModal-@info.InformationId" class="modal" style="display: none; position: fixed; z-index: 1; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0, 0, 0, 0.4);">
                                                    <div class="modal-content" style="background-color: #fefefe; margin: 10% auto; padding: 20px; border: 1px solid #888; width: 80%; max-width: 600px; border-radius: 8px;">
                                                        <span class="close" onclick="closeUpdateForm('@info.InformationId')" style="color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer;">&times;</span>
                                                        <h3>Cập nhật thông tin dự án</h3>
                                                        <form method="post" asp-page-handler="Update" enctype="multipart/form-data" style="display: flex; flex-direction: column; gap: 15px;">
                                                            <input type="hidden" name="projectId" id="projectId-@info.InformationId" value="@info.InformationId" />
                                                            <input type="hidden" name="uid"  value="@info.Profile.UserId" />

                                                            <div style="display: flex; flex-direction: column;">
                                                                <label for="content-@info.InformationId" style="font-weight: 500; margin-bottom: 5px;">Mô Tả:</label>
                                                                <textarea id="content-@info.InformationId" name="content" rows="4" required
                                                                          style="border: 1px solid #ddd; border-radius: 8px; padding: 10px; font-size: 16px; resize: vertical;">@info.Content</textarea>
                                                            </div>

                                                            @*   <div style="display: flex; flex-direction: column;">
                                                    <label for="video-@info.InformationId" style="font-weight: 500; margin-bottom: 5px;">Video (nếu có):</label>
                                                    <input type="file" id="video-@info.InformationId" name="video" accept="video/*" multiple style="padding: 8px; border-radius: 8px; border: 1px solid #ddd;" />
                                                    </div> *@

                                                            <div style="display: flex; flex-direction: column;">
                                                                <label for="images-@info.InformationId" style="font-weight: 500; margin-bottom: 5px;">Hình Ảnh,Video (nếu có):</label>
                                                                <input type="file" id="images-@info.InformationId" name="images" accept="image/*,video/*" multiple style="padding: 8px; border-radius: 8px; border: 1px solid #ddd;" />
                                                                <small style="color: #888;">(Hold Ctrl to select multiple images)</small>
                                                            </div>

                                                            <button type="submit" style="background-color: #007bff; color: white; padding: 12px; font-size: 16px; border: none; border-radius: 8px; cursor: pointer; transition: background-color 0.3s;">
                                                                Cập nhật
                                                            </button>
                                                        </form>
                                                    </div>
                                                </div>



                                                <form method="post" asp-page-handler="Delete" style="display:inline-block">
                                                    <input type="hidden" name="id" value="@info.InformationId" />
                                                    <input type="hidden" name="uid" value="@info.Profile.UserId" />

                                                    <button type="submit" style="background:#dc3545;width:44px" class="btn btn-sm">Xóa</button>
                                                </form>
                                            }

                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>

                        <!-- If no data is available -->
                        @if (Model.ProjectInformationListU.Count == 0)
                        {
                            <p>Không có thông tin nào được cập nhật.</p>
                        }
                    </div>
                </div>
            </div>


            <!-- Add Information Modal -->
            <div id="addModal" class="modal" style="display: none; position: fixed; z-index: 1; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0, 0, 0, 0.4);">
                <div class="modal-content" style="background-color: #fefefe; margin: 15% auto; padding: 20px; border: 1px solid #888; width: 80%;">
                    <span class="close" onclick="document.getElementById('addModal').style.display='none'" style="color: #aaa; float: right; font-size: 28px; font-weight: bold;">&times;</span>
                    <div class="container">
                        <h2>Thêm Thông Tin</h2>
                        <form method="post" enctype="multipart/form-data">
                            <div class="form-group">
                                <label for="Content">Nội dung</label>
                                <input type="text" id="Content" name="Content" class="form-control" required />
                                @if (charityId != null)
                                {
                                    <input type="text" id="charityid" name="charityid" value="@charityId" class="form-control" hidden/>
                                }
                            </div>
                            <div class="form-group" hidden>
                                <label for="CampaignId">Mã Chiến Dịch</label>
                                <input type="text" id="CampaignId" name="CampaignId" value="@(Model.Campaign?.CampaignId ?? 0)" class="form-control" required />
                            </div>
                            <div class="form-group" hidden>
                                <label for="ProfileId">Mã Hồ Sơ</label>
                                <input type="text" id="ProfileId" name="ProfileId" value="@(Model.VolunteerHistory?.ProfileId ?? 0)" class="form-control" required />
                            </div>
                            @*  <div class="form-group">
                            <label for="video">Video</label>
                            <input type="file" id="video" name="video" class="form-control" accept="video/*" multiple />
                            </div> *@
                            <div class="form-group">
                                <label for="Images">Hình ảnh</label>
                                <input type="file" id="Images" name="Images" class="form-control" accept="image/*,video/*" multiple />
                            </div>
                            <input type="hidden" name="uid" value="@userId" />

                            <button type="submit" class="btn btn-primary">Thêm</button>
                        </form>
                    </div>
                </div>
            </div>
            <div class="information-list" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(400px, 1fr)); gap: 20px;">
                <!-- Information Modal -->
                <div id="infoModal" class="modal" style="display: none; position: fixed; z-index: 1; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0, 0, 0, 0.4);">
                    <div class="modal-content" style="background-color: #fefefe; margin: 10% auto; padding: 20px; border: 1px solid #888; width: 80%; display: flex; flex-direction: column; gap: 20px; border-radius: 8px;">
                        <span class="close" onclick="document.getElementById('infoModal').style.display='none'" style="color: #aaa; font-size: 28px; font-weight: bold; cursor: pointer;">&times;</span>

                        <div class="profile-section" style="display: flex; gap: 20px; align-items: flex-start; background-color: #ffffff; border-radius: 8px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);">
                            <!-- Profile details on the left side -->
                            <div class="profile-details" style="flex: 1; padding: 20px;">
                                <h2 class="fw-bold text-uppercase mb-4" style="font-size: 24px; color: #333; text-align: center;">Chi tiết</h2>
                                <h3 id="modalProfile" style="font-size: 1.5rem; color: #333; margin-bottom: 10px;"></h3>
                                <div id="modalDate" style="color: #666; font-size: 0.9rem; margin-bottom: 15px;"></div>
                                <div id="modalContent" style="color: #333; margin-bottom: 10px;text-align: justify;"></div>

                                @*  <p id="modalLocation" style="color: #555; font-weight: bold; margin: 15px 0;"></p>
                                <p id="modalDescription" style="color: #555; line-height: 1.6;"></p> *@
                            </div>

                            <!-- Media container (combined for images and videos) -->
                            <div style="flex: 1; padding: 20px; position: relative;width: 800px; height: 600px;y">
                                <button id="prevMedia" style="position: absolute; top: 50%; left: 0; transform: translateY(-50%); background-color: rgba(0, 0, 0, 0.5); color: white; border: none; padding: 10px; cursor: pointer; z-index: 10;">&lt;</button>
                                <div id="modalMedia" style="margin-top: 10px; display: flex; justify-content: center; align-items: center; height: 100%; overflow: hidden;">
                                    <!-- Media content (videos/images) will be dynamically inserted here -->
                                </div>
                                <button id="nextMedia" style="position: absolute; top: 50%; right: 0; transform: translateY(-50%); background-color: rgba(0, 0, 0, 0.5); color: white; border: none; padding: 10px; cursor: pointer; z-index: 10;">&gt;</button>
                            </div>

                        </div>
                    </div>
                </div>
                @if (Model.ProjectInformationList != null && Model.ProjectInformationList.Count > 0)
                {
                    if (charityId != null && userId != null && Model.Campaign.CharityId.ToString() == charityId)
                    {
                        foreach (var info in Model.ProjectInformationList)
                        {
                            <div class="info-item" style="background-color: #f9f9f9; border-radius: 8px; padding: 15px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); text-align: center;" data-content="@info.Content" data-profile="@info.Profile.User.Username" data-date="@info.CreateDate.ToShortDateString()">

                                @if (info.Campaign.CharityId.ToString() == @charityId && info.Status == "0")
                                {
                                    <form method="post" asp-page-handler="Approve" style="display:inline-block; margin-left: 10px;">
                                        <input type="hidden" name="projectId" value="@info.InformationId" />
                                        <input type="hidden" name="uid" value="@info.Profile.UserId" />

                                        <button type="submit" style="background:#ffc107;width:65.28px" class="btn btn-sm">Duyệt</button>
                                    </form>

                                    <form method="post" asp-page-handler="Delete" style="display:inline-block; margin-left: 10px;">
                                        <input type="hidden" name="id" value="@info.InformationId" />
                                        <input type="hidden" name="uid" value="@userId" />

                                        <button type="submit" style="background:#dc3545" class="btn btn-sm">Từ chối</button>
                                    </form>
                                }
                                @if (info.Campaign.CharityId.ToString() == @charityId && info.Status == "1")
                                {

                                    <form method="post" asp-page-handler="UnApprove" style="display:inline-block; margin-left: 10px;">
                                        <input type="hidden" name="projectId" value="@info.InformationId" />
                                        <input type="hidden" name="uid" value="@info.Profile.UserId" />
                                        <button type="submit" style="background:#ffc107;width:83px" class="btn btn-sm">Huỷ Duyệt</button>
                                    </form>
                                }
                                <h3 style="font-size: 18px; color: #333; margin-bottom: 10px;"> @info.Profile.User.Username</h3>
                                <p class="date" style="font-size: 14px; color: #555; margin: 5px 0;">Ngày đăng: @info.CreateDate.ToShortDateString()</p>
                                <h4 hidden style="font-size: 18px; color: #333; margin-bottom: 10px;text-align: justify;">@info.Content</h4>
                                <h2 style="font-size: 18px; color: #333; margin-bottom: 10px; text-align: justify;">
                                    @Html.Raw(!string.IsNullOrEmpty(info.Content) && info.Content.Length > 150
                                             ? info.Content.Substring(0, 150) + "..."
                                             : info.Content)
                                </h2>

                                @*  <!-- Display all videos -->
                    @if (!string.IsNullOrEmpty(info.Video))
                    {
                    var videos = info.Video.Split(',');
                    <div class="videos" style="margin-top: 10px;" hidden>
                    @foreach (var video in videos)
                    {
                    <video controls style="border-radius: 5px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); margin: 5px; width: 100%; max-width: 300px; height: auto;">
                    <source src="~/uploads/projectInformation/@video" type="video/mp4">
                    Your browser does not support the video tag.
                    </video>
                    }
                    </div>
                    } *@
                                <!-- Display all images -->
                                @if (!string.IsNullOrEmpty(info.Img))
                                {
                                    var images = info.Img.Split(',');
                                    <div class="images" id="mediaCarouselContainer" style="width: 800px; height: 600px; position: relative; margin: auto; overflow: hidden; background-color: #f9f9f9; border-radius: 8px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); padding: 20px;" hidden>
                                        <div id="mediaCarousel" style="width: 100%; height: 100%; display: flex; justify-content: center; align-items: center;">

                                            @foreach (var file in images)
                                            {
                                                var fileExtension = System.IO.Path.GetExtension(file).ToLower();
                                                if (fileExtension == ".jpg" || fileExtension == ".jpeg" || fileExtension == ".png" || fileExtension == ".gif")
                                                {
                                                    <img src="~/uploads/projectInformation/@file" alt="Project Image"
                                                         style="border-radius: 5px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); margin: 5px; width: 100%; max-width: 120px; height: auto;" />
                                                }
                                                else if (fileExtension == ".mp4" || fileExtension == ".webm" || fileExtension == ".ogg")
                                                {
                                                    <video controls style="border-radius: 5px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); margin: 5px; width: 100%; max-width: 240px; height: auto;">
                                                        <source src="~/uploads/projectInformation/@file" type="video/@fileExtension.TrimStart('.')" />
                                                        Your browser does not support the video tag.
                                                    </video>
                                                }
                                            }
                                        </div>
                                    </div>
                                }


                                @*     <!-- Display limited videos if available -->
                    @if (!string.IsNullOrEmpty(info.Video))
                    {
                    var videos1 = info.Video.Split(',');
                    <div class="videos" style="margin-top: 10px;">
                    <h5 style="font-size: 16px; color: #666; margin-bottom: 5px;"></h5>
                    @for (int i = 0; i < videos1.Length; i++)
                    {
                    if (i < 2)  // Display only the first 2 videos
                    {
                    <video controls style="border-radius: 5px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); margin: 5px; width: 100%; max-width: 120px; height: auto;">
                    <source src="~/uploads/projectInformation/@videos1[i]" type="video/mp4">
                    Your browser does not support the video tag.
                    </video>
                    }
                    else if (i == 2)  // Display overlay for additional videos
                    {
                    <div style="position: relative; display: inline-block;">
                    <video controls style="border-radius: 5px; opacity: 0.5; filter: blur(2px); margin: 5px; width: 100%; max-width: 120px; height: auto;">
                    <source src="~/uploads/projectInformation/@videos1[i]" type="video/mp4">
                    Your browser does not support the video tag.
                    </video>
                    <span style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: white; font-weight: bold; background-color: rgba(0, 0, 0, 0.6); padding: 5px 10px; border-radius: 5px;">
                    +@((videos1.Length - 2).ToString())
                    </span>
                    </div>
                    break;
                    }
                    }
                    </div>
                    }
                    *@
                                <!-- Display limited images if available -->
                                @if (!string.IsNullOrEmpty(info.Img))
                                {
                                    var mediaFiles = info.Img.Split(',');
                                    <div class="media" style="margin-top: 10px; display: flex; flex-wrap: wrap; justify-content: center; gap: 10px;">
                                        @for (int i = 0; i < mediaFiles.Length; i++)
                                        {
                                            var file = mediaFiles[i];
                                            var extension = System.IO.Path.GetExtension(file).ToLower();

                                            if (i < 1)  // Display only the first 2 media files
                                            {
                                                if (extension == ".jpg" || extension == ".jpeg" || extension == ".png" || extension == ".gif")
                                                {
                                                    // Display image
                                                    <img src="~/uploads/projectInformation/@file" alt="Project Image"
                                                         style="border-radius: 5px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); width: 100%; max-width: 200px; height: auto; object-fit: cover;" />
                                                }
                                                else if (extension == ".mp4" || extension == ".webm" || extension == ".ogg")
                                                {
                                                    // Display video
                                                    <video controls style="border-radius: 5px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); width: 100%; max-width: 240px; height: auto; object-fit: cover;">
                                                        <source src="~/uploads/projectInformation/@file" type="video/@extension.TrimStart('.')" />
                                                        Your browser does not support the video tag.
                                                    </video>
                                                }
                                            }
                                            else if (i == 1)  // Display overlay for additional media files
                                            {
                                                <div style="position: relative; display: inline-block;">
                                                    @if (extension == ".jpg" || extension == ".jpeg" || extension == ".png" || extension == ".gif")
                                                    {
                                                        // Display image
                                                        <img src="~/uploads/projectInformation/@file" alt="Project Image"
                                                             style="border-radius: 5px; opacity: 0.5; filter: blur(2px); width: 100%; max-width: 200px; height: auto; object-fit: cover;" />
                                                    }
                                                    else if (extension == ".mp4" || extension == ".webm" || extension == ".ogg")
                                                    {
                                                        // Display video
                                                        <video controls style="border-radius: 5px; opacity: 0.5; filter: blur(2px); width: 100%; max-width: 200px; height: auto; object-fit: cover;">
                                                            <source src="~/uploads/projectInformation/@file" type="video/@extension.TrimStart('.')" />
                                                            Your browser does not support the video tag.
                                                        </video>
                                                    }
                                                    <span style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: white; font-weight: bold; background-color: rgba(0, 0, 0, 0.6); padding: 5px 10px; border-radius: 5px;">
                                                        +@((mediaFiles.Length - 2).ToString())
                                                    </span>
                                                </div>
                                                break;
                                            }
                                        }
                                    </div>
                                }


                            </div>
                        }
                    }
                    else
                    {
                        foreach (var info in Model.ProjectInformationList1)
                        {
                            <div class="info-item" style="background-color: #f9f9f9; border-radius: 8px; padding: 15px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); text-align: center;" data-content="@info.Content" data-profile="@info.Profile.User.Username" data-date="@info.CreateDate.ToShortDateString()">

                                @*  @if (info.Profile.UserId.ToString() == userId)
                    {
                    <button type="button" class="btn btn-warning" style="padding: 10px; color: white; height: fit-content"
                    onclick="showUpdateForm('@info.InformationId', '@Html.Raw(Html.Encode(info.Content))', '@info.Img', '@info.Video')">
                    Sửa
                    </button>

                    <!-- Update Project Modal -->
                    <div id="updateModal-@info.InformationId" class="modal" style="display: none; position: fixed; z-index: 1; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0, 0, 0, 0.4);">
                    <div class="modal-content" style="background-color: #fefefe; margin: 10% auto; padding: 20px; border: 1px solid #888; width: 80%; max-width: 600px; border-radius: 8px;">
                    <span class="close" onclick="closeUpdateForm('@info.InformationId')" style="color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer;">&times;</span>
                    <h3>Cập nhật thông tin dự án</h3>
                    <form method="post" asp-page-handler="Update" enctype="multipart/form-data" style="display: flex; flex-direction: column; gap: 15px;">
                    <input type="hidden" name="projectId" id="projectId-@info.InformationId" value="@info.InformationId" />

                    <div style="display: flex; flex-direction: column;">
                    <label for="content-@info.InformationId" style="font-weight: 500; margin-bottom: 5px;">Mô Tả:</label>
                    <textarea id="content-@info.InformationId" name="content" rows="4" required
                    style="border: 1px solid #ddd; border-radius: 8px; padding: 10px; font-size: 16px; resize: vertical;">@info.Content</textarea>
                    </div>

                    <div style="display: flex; flex-direction: column;">
                    <label for="video-@info.InformationId" style="font-weight: 500; margin-bottom: 5px;">Video (nếu có):</label>
                    <input type="file" id="video-@info.InformationId" name="video" accept="video/*" multiple style="padding: 8px; border-radius: 8px; border: 1px solid #ddd;" />
                    </div>

                    <div style="display: flex; flex-direction: column;">
                    <label for="images-@info.InformationId" style="font-weight: 500; margin-bottom: 5px;">Hình Ảnh (nếu có):</label>
                    <input type="file" id="images-@info.InformationId" name="images" accept="image/*" multiple style="padding: 8px; border-radius: 8px; border: 1px solid #ddd;" />
                    <small style="color: #888;">(Hold Ctrl to select multiple images)</small>
                    </div>

                    <button type="submit" style="background-color: #007bff; color: white; padding: 12px; font-size: 16px; border: none; border-radius: 8px; cursor: pointer; transition: background-color 0.3s;">
                    Cập nhật
                    </button>
                    </form>
                    </div>
                    </div>



                    <form method="post" asp-page-handler="Delete" style="display:inline-block; margin-left: 10px;">
                    <input type="hidden" name="id" value="@info.InformationId" />
                    <button type="submit" class="btn btn-danger btn-sm">Xóa</button>
                    </form>
                    } *@
                                @if (info.Campaign.CharityId.ToString() == @charityId && info.Status == "0")
                                {
                                    <form method="post" asp-page-handler="Approve" style="display:inline-block; margin-left: 10px;">
                                        <input type="hidden" name="projectId" value="@info.InformationId" />
                                        <button type="submit" class="btn btn-primary btn-sm">Duyệt</button>
                                    </form>

                                    <form method="post" asp-page-handler="Delete" style="display:inline-block; margin-left: 10px;">
                                        <input type="hidden" name="id" value="@info.InformationId" />
                                        <button type="submit" class="btn btn-danger btn-sm">Xóa</button>
                                    </form>
                                }
                                <h3 style="font-size: 18px; color: #333; margin-bottom: 10px;"> @info.Profile.User.Username</h3>
                                <p class="date" style="font-size: 14px; color: #555; margin: 5px 0;">Ngày: @info.CreateDate.ToShortDateString()</p>
                                <h4 hidden style="font-size: 18px; color: #333; margin-bottom: 10px;text-align: justify;">@info.Content</h4>
                                <h2 style="font-size: 18px; color: #333; margin-bottom: 10px; text-align: justify;">
                                    @Html.Raw(!string.IsNullOrEmpty(info.Content) && info.Content.Length > 150
                                             ? info.Content.Substring(0, 150) + "..."
                                             : info.Content)
                                </h2>

                                <!-- Display all images -->
                                @if (!string.IsNullOrEmpty(info.Img))
                                {
                                    var images = info.Img.Split(',');
                                    <div class="images" id="mediaCarouselContainer" style="width: 800px; height: 600px; position: relative; margin: auto; overflow: hidden; background-color: #f9f9f9; border-radius: 8px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); padding: 20px;" hidden>
                                        <div id="mediaCarousel" style="width: 100%; height: 100%; display: flex; justify-content: center; align-items: center;">

                                            @foreach (var file in images)
                                            {
                                                var fileExtension = System.IO.Path.GetExtension(file).ToLower();
                                                if (fileExtension == ".jpg" || fileExtension == ".jpeg" || fileExtension == ".png" || fileExtension == ".gif")
                                                {
                                                    <img src="~/uploads/projectInformation/@file" alt="Project Image"
                                                         style="border-radius: 5px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); margin: 5px; width: 100%; max-width: 120px; height: auto;" />
                                                }
                                                else if (fileExtension == ".mp4" || fileExtension == ".webm" || fileExtension == ".ogg")
                                                {
                                                    <video controls style="border-radius: 5px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); margin: 5px; width: 100%; max-width: 240px; height: auto;">
                                                        <source src="~/uploads/projectInformation/@file" type="video/@fileExtension.TrimStart('.')" />
                                                        Your browser does not support the video tag.
                                                    </video>
                                                }
                                            }
                                        </div>
                                    </div>
                                }


                                <!-- Display limited images if available -->
                                <!-- Display limited images if available -->
                                @if (!string.IsNullOrEmpty(info.Img))
                                {
                                    var mediaFiles = info.Img.Split(',');
                                    <div class="media" style="margin-top: 10px; display: flex; flex-wrap: wrap; justify-content: center; gap: 10px;">
                                        @for (int i = 0; i < mediaFiles.Length; i++)
                                        {
                                            var file = mediaFiles[i];
                                            var extension = System.IO.Path.GetExtension(file).ToLower();

                                            if (i < 1)  // Display only the first 2 media files
                                            {
                                                if (extension == ".jpg" || extension == ".jpeg" || extension == ".png" || extension == ".gif")
                                                {
                                                    // Display image
                                                    <img src="~/uploads/projectInformation/@file" alt="Project Image"
                                                         style="border-radius: 5px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); width: 100%; max-width: 200px; height: auto; object-fit: cover;" />
                                                }
                                                else if (extension == ".mp4" || extension == ".webm" || extension == ".ogg")
                                                {
                                                    // Display video
                                                    <video controls style="border-radius: 5px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); width: 100%; max-width: 240px; height: auto; object-fit: cover;">
                                                        <source src="~/uploads/projectInformation/@file" type="video/@extension.TrimStart('.')" />
                                                        Your browser does not support the video tag.
                                                    </video>
                                                }
                                            }
                                            else if (i == 1)  // Display overlay for additional media files
                                            {
                                                <div style="position: relative; display: inline-block;">
                                                    @if (extension == ".jpg" || extension == ".jpeg" || extension == ".png" || extension == ".gif")
                                                    {
                                                        // Display image
                                                        <img src="~/uploads/projectInformation/@file" alt="Project Image"
                                                             style="border-radius: 5px; opacity: 0.5; filter: blur(2px); width: 100%; max-width: 200px; height: auto; object-fit: cover;" />
                                                    }
                                                    else if (extension == ".mp4" || extension == ".webm" || extension == ".ogg")
                                                    {
                                                        // Display video
                                                        <video controls style="border-radius: 5px; opacity: 0.5; filter: blur(2px); width: 100%; max-width: 200px; height: auto; object-fit: cover;">
                                                            <source src="~/uploads/projectInformation/@file" type="video/@extension.TrimStart('.')" />
                                                            Your browser does not support the video tag.
                                                        </video>
                                                    }
                                                    <span style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: white; font-weight: bold; background-color: rgba(0, 0, 0, 0.6); padding: 5px 10px; border-radius: 5px;">
                                                        +@((mediaFiles.Length - 2).ToString())
                                                    </span>
                                                </div>
                                                break;
                                            }
                                        }
                                    </div>
                                }
                            </div>
                        }
                        @if (Model.ProjectInformationList1.Count == 0)
                        {
                            <p>Không có thông tin nào được cập nhật.</p>
                        }
                    }

                }
                else
                {
                    <p style="text-align:center">Hiện tại chưa có thông tin nào .</p>
                }
            </div>







        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const addButton = document.getElementById('addButton');
        const addModal = document.getElementById('addModal');

        if (addButton && addModal) {
            addButton.onclick = function () {
                addModal.style.display = 'block';
            };
        } else {
            console.error('addButton or addModal is missing from the DOM!');
        }
    });


    window.onclick = function (event) {
        if (event.target == document.getElementById('addModal')) {
            document.getElementById('addModal').style.display = 'none';
        }
    }

    document.addEventListener('DOMContentLoaded', () => {
        const modal = document.getElementById('infoModal');
        const modalContent = document.getElementById('modalContent');
        const modalProfile = document.getElementById('modalProfile');
        const modalDate = document.getElementById('modalDate');
        const modalMedia = document.getElementById('modalMedia');
        const nextMediaBtn = document.getElementById('nextMedia');
        const prevMediaBtn = document.getElementById('prevMedia');

        if (!modal || !modalContent || !modalProfile || !modalDate || !modalMedia || !nextMediaBtn || !prevMediaBtn) {
            console.error('One or more modal elements are missing!');
            return;
        }

        document.querySelectorAll('.info-item').forEach(item => {
            item.onclick = function () {
                const content = this.querySelector('h4')?.innerText || '';
                const profile = this.querySelector('h3')?.innerText || '';
                const date = this.querySelector('.date')?.innerText || '';
                const videos = this.querySelector('.videos')?.innerHTML || '';
                const images = this.querySelector('.images')?.innerHTML || '';

                modalProfile.innerHTML = `<h2>${profile}</h2>`;
                modalDate.innerHTML = `<p><strong></strong> ${date}</p>`;
                modalContent.innerHTML = `<h3>${content}</h3>`;
                modalMedia.innerHTML = `${videos}${images}`;

                let currentMediaIndex = 0;
                const allMediaElements = [...modalMedia.querySelectorAll('video'), ...modalMedia.querySelectorAll('img')];
                allMediaElements.forEach((media, index) => {
                    media.style.display = index === currentMediaIndex ? 'block' : 'none';
                    media.style.maxWidth = '100%';
                    media.style.maxHeight = '100%';
                });

                nextMediaBtn.onclick = () => {
                    allMediaElements[currentMediaIndex].style.display = 'none';
                    currentMediaIndex = (currentMediaIndex + 1) % allMediaElements.length;
                    allMediaElements[currentMediaIndex].style.display = 'block';
                };

                prevMediaBtn.onclick = () => {
                    allMediaElements[currentMediaIndex].style.display = 'none';
                    currentMediaIndex = (currentMediaIndex - 1 + allMediaElements.length) % allMediaElements.length;
                    allMediaElements[currentMediaIndex].style.display = 'block';
                };

                modal.style.display = 'block';
            };
        });

        window.onclick = function (event) {
            if (event.target == modal) {
                modal.style.display = 'none';
            }
        };
    });



</script>
<script>
    // Show the modal and populate data
    function showUpdateForm(id, content, img, video) {
        console.log("showUpdateForm called with id:", id, content, img, video); // Debugging line
        document.getElementById('projectId-' + id).value = id;
        document.getElementById('content-' + id).value = content;
        document.getElementById('updateModal-' + id).style.display = 'block';
    }

    // Close the modal
    function closeUpdateForm(id) {
        document.getElementById('updateModal-' + id).style.display = 'none';
    }

    // Close the modal if clicked outside of it
    window.onclick = function (event) {
        var modals = document.querySelectorAll('.modal');
        modals.forEach(function (modal) {
            if (event.target == modal) {
                modal.style.display = 'none';
            }
        });
    }
</script>
<script>
    // Get modal and button elements
    const listButton = document.getElementById('listButton');
    const listModal = document.getElementById('listModal');
    const closeModal = () => {
        listModal.style.display = 'none';  // Close modal
    };

    // Show the modal when the button is clicked
    if (listButton) {
        listButton.onclick = function () {
            listModal.style.display = 'block';
        };
    }

    // Close modal when clicking outside of it
    window.onclick = function (event) {
        if (event.target == listModal) {
            closeModal();
        }
    };
</script>